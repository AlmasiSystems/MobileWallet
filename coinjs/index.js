import './shim.js'

/*
 Coinjs 0.01 beta by OutCast3k{at}gmail.com
 A bitcoin framework.

 http://github.com/OutCast3k/coinjs or http://coinb.in/coinjs
*/

module.exports=function(){var t,e,r=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],s=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],n=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],u=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],h=[0,1518500249,1859775393,2400959708,2840853838],c=[1352829926,1548603684,1836072691,2053994217,0],a=function(t){for(var e=[],r=0,i=0;r<t.length;r++,i+=8)e[i>>>5]|=t[r]<<24-i%32;return e},p=function(t){for(var e=[],r=0;r<32*t.length;r+=8)e.push(t[r>>>5]>>>24-r%32&255);return e},f=function(t,e,i){for(var o=0;o<16;o++){var a=i+o,p=e[a];e[a]=16711935&(p<<8|p>>>24)|4278255360&(p<<24|p>>>8)}var f,y,v,T,w,F,C,k,x,S,A;F=f=t[0],C=y=t[1],k=v=t[2],x=T=t[3],S=w=t[4];for(o=0;o<80;o+=1)A=f+e[i+r[o]]|0,A+=o<16?l(y,v,T)+h[0]:o<32?d(y,v,T)+h[1]:o<48?g(y,v,T)+h[2]:o<64?m(y,v,T)+h[3]:b(y,v,T)+h[4],A=(A=B(A|=0,n[o]))+w|0,f=w,w=T,T=B(v,10),v=y,y=A,A=F+e[i+s[o]]|0,A+=o<16?b(C,k,x)+c[0]:o<32?m(C,k,x)+c[1]:o<48?g(C,k,x)+c[2]:o<64?d(C,k,x)+c[3]:l(C,k,x)+c[4],A=(A=B(A|=0,u[o]))+S|0,F=S,S=x,x=B(k,10),k=C,C=A;A=t[1]+v+x|0,t[1]=t[2]+T+S|0,t[2]=t[3]+w+F|0,t[3]=t[4]+f+C|0,t[4]=t[0]+y+k|0,t[0]=A};function l(t,e,r){return t^e^r}function d(t,e,r){return t&e|~t&r}function g(t,e,r){return(t|~e)^r}function m(t,e,r){return t&r|e&~r}function b(t,e,r){return t^(e|~r)}function B(t,e){return t<<e|t>>>32-e}function T(t){var e=[1732584193,4023233417,2562383102,271733878,3285377520],r=a(t),i=8*t.length,s=8*t.length;r[i>>>5]|=128<<24-i%32,r[14+(i+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8);for(var n=0;n<r.length;n+=16)f(e,r,n);for(n=0;n<5;n++){var o=e[n];e[n]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8)}return p(e)}(t=window.EllipticCurve=function(){}).FieldElementFp=function(t,e){this.x=e,this.q=t},t.FieldElementFp.prototype.equals=function(t){return t==this||this.q.equals(t.q)&&this.x.equals(t.x)},t.FieldElementFp.prototype.toBigInteger=function(){return this.x},t.FieldElementFp.prototype.negate=function(){return new t.FieldElementFp(this.q,this.x.negate().mod(this.q))},t.FieldElementFp.prototype.add=function(e){return new t.FieldElementFp(this.q,this.x.add(e.toBigInteger()).mod(this.q))},t.FieldElementFp.prototype.subtract=function(e){return new t.FieldElementFp(this.q,this.x.subtract(e.toBigInteger()).mod(this.q))},t.FieldElementFp.prototype.multiply=function(e){return new t.FieldElementFp(this.q,this.x.multiply(e.toBigInteger()).mod(this.q))},t.FieldElementFp.prototype.square=function(){return new t.FieldElementFp(this.q,this.x.square().mod(this.q))},t.FieldElementFp.prototype.divide=function(e){return new t.FieldElementFp(this.q,this.x.multiply(e.toBigInteger().modInverse(this.q)).mod(this.q))},t.FieldElementFp.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)},t.FieldElementFp.prototype.sqrt=function(){if(!this.q.testBit(0))throw new Error("even value of q");if(this.q.testBit(1)){var e=new t.FieldElementFp(this.q,this.x.modPow(this.q.shiftRight(2).add(w.ONE),this.q));return e.square().equals(this)?e:null}var r=this.q.subtract(w.ONE),i=r.shiftRight(1);if(!this.x.modPow(i,this.q).equals(w.ONE))return null;var s,n,o=r.shiftRight(2).shiftLeft(1).add(w.ONE),u=this.x,h=u.shiftLeft(2).mod(this.q);do{var c,a=new SecureRandom;do{c=new w(this.q.bitLength(),a)}while(c.compareTo(this.q)>=0||!c.multiply(c).subtract(h).modPow(i,this.q).equals(r));var p=t.FieldElementFp.fastLucasSequence(this.q,c,u,o);if(s=p[0],(n=p[1]).multiply(n).mod(this.q).equals(h))return n.testBit(0)&&(n=n.add(this.q)),n=n.shiftRight(1),new t.FieldElementFp(this.q,n)}while(s.equals(w.ONE)||s.equals(r));return null},t.FieldElementFp.fastLucasSequence=function(t,e,r,i){for(var s=i.bitLength(),n=i.getLowestSetBit(),o=w.ONE,u=w.TWO,h=e,c=w.ONE,a=w.ONE,p=s-1;p>=n+1;--p)c=c.multiply(a).mod(t),i.testBit(p)?(a=c.multiply(r).mod(t),o=o.multiply(h).mod(t),u=h.multiply(u).subtract(e.multiply(c)).mod(t),h=h.multiply(h).subtract(a.shiftLeft(1)).mod(t)):(a=c,o=o.multiply(u).subtract(c).mod(t),h=h.multiply(u).subtract(e.multiply(c)).mod(t),u=u.multiply(u).subtract(c.shiftLeft(1)).mod(t));for(a=(c=c.multiply(a).mod(t)).multiply(r).mod(t),o=o.multiply(u).subtract(c).mod(t),u=h.multiply(u).subtract(e.multiply(c)).mod(t),c=c.multiply(a).mod(t),p=1;p<=n;++p)o=o.multiply(u).mod(t),u=u.multiply(u).subtract(c.shiftLeft(1)).mod(t),c=c.multiply(c).mod(t);return[o,u]},t.PointFp=function(t,e,r,i,s){this.curve=t,this.x=e,this.y=r,this.z=null==i?w.ONE:i,this.zinv=null,this.compressed=!!s},t.PointFp.prototype.getX=function(){null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q));var t=this.x.toBigInteger().multiply(this.zinv);return this.curve.reduce(t),this.curve.fromBigInteger(t)},t.PointFp.prototype.getY=function(){null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q));var t=this.y.toBigInteger().multiply(this.zinv);return this.curve.reduce(t),this.curve.fromBigInteger(t)},t.PointFp.prototype.equals=function(t){return t==this||(this.isInfinity()?t.isInfinity():t.isInfinity()?this.isInfinity():!!t.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(t.z)).mod(this.curve.q).equals(w.ZERO)&&t.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(t.z)).mod(this.curve.q).equals(w.ZERO))},t.PointFp.prototype.isInfinity=function(){return null==this.x&&null==this.y||this.z.equals(w.ZERO)&&!this.y.toBigInteger().equals(w.ZERO)},t.PointFp.prototype.negate=function(){return new t.PointFp(this.curve,this.x,this.y.negate(),this.z)},t.PointFp.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var r=e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.q),i=e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.q);if(w.ZERO.equals(i))return w.ZERO.equals(r)?this.twice():this.curve.getInfinity();var s=new w("3"),n=this.x.toBigInteger(),o=this.y.toBigInteger(),u=(e.x.toBigInteger(),e.y.toBigInteger(),i.square()),h=u.multiply(i),c=n.multiply(u),a=r.square().multiply(this.z),p=a.subtract(c.shiftLeft(1)).multiply(e.z).subtract(h).multiply(i).mod(this.curve.q),f=c.multiply(s).multiply(r).subtract(o.multiply(h)).subtract(a.multiply(r)).multiply(e.z).add(r.multiply(h)).mod(this.curve.q),l=h.multiply(this.z).multiply(e.z).mod(this.curve.q);return new t.PointFp(this.curve,this.curve.fromBigInteger(p),this.curve.fromBigInteger(f),l)},t.PointFp.prototype.twice=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var e=new w("3"),r=this.x.toBigInteger(),i=this.y.toBigInteger(),s=i.multiply(this.z),n=s.multiply(i).mod(this.curve.q),o=this.curve.a.toBigInteger(),u=r.square().multiply(e);w.ZERO.equals(o)||(u=u.add(this.z.square().multiply(o)));var h=(u=u.mod(this.curve.q)).square().subtract(r.shiftLeft(3).multiply(n)).shiftLeft(1).multiply(s).mod(this.curve.q),c=u.multiply(e).multiply(r).subtract(n.shiftLeft(1)).shiftLeft(2).multiply(n).subtract(u.square().multiply(u)).mod(this.curve.q),a=s.square().multiply(s).shiftLeft(3).mod(this.curve.q);return new t.PointFp(this.curve,this.curve.fromBigInteger(h),this.curve.fromBigInteger(c),a)},t.PointFp.prototype.multiply=function(t){if(this.isInfinity())return this;if(0==t.signum())return this.curve.getInfinity();var e,r=t,i=r.multiply(new w("3")),s=this.negate(),n=this;for(e=i.bitLength()-2;e>0;--e){n=n.twice();var o=i.testBit(e);o!=r.testBit(e)&&(n=n.add(o?this:s))}return n},t.PointFp.prototype.multiplyTwo=function(t,e,r){var i;i=t.bitLength()>r.bitLength()?t.bitLength()-1:r.bitLength()-1;for(var s=this.curve.getInfinity(),n=this.add(e);i>=0;)s=s.twice(),t.testBit(i)?s=r.testBit(i)?s.add(n):s.add(this):r.testBit(i)&&(s=s.add(e)),--i;return s},t.PointFp.prototype.getEncoded=function(e){var r=this.getX().toBigInteger(),i=this.getY().toBigInteger(),s=t.integerToBytes(r,32);return e?i.isEven()?s.unshift(2):s.unshift(3):(s.unshift(4),s=s.concat(t.integerToBytes(i,32))),s},t.PointFp.decodeFrom=function(e,r){r[0];var i=r.length-1,s=r.slice(1,1+i/2),n=r.slice(1+i/2,1+i);s.unshift(0),n.unshift(0);var o=new w(s),u=new w(n);return new t.PointFp(e,e.fromBigInteger(o),e.fromBigInteger(u))},t.PointFp.prototype.add2D=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;if(this.x.equals(e.x))return this.y.equals(e.y)?this.twice():this.curve.getInfinity();var r=e.x.subtract(this.x),i=e.y.subtract(this.y).divide(r),s=i.square().subtract(this.x).subtract(e.x),n=i.multiply(this.x.subtract(s)).subtract(this.y);return new t.PointFp(this.curve,s,n)},t.PointFp.prototype.twice2D=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var e=this.curve.fromBigInteger(w.valueOf(2)),r=this.curve.fromBigInteger(w.valueOf(3)),i=this.x.square().multiply(r).add(this.curve.a).divide(this.y.multiply(e)),s=i.square().subtract(this.x.multiply(e)),n=i.multiply(this.x.subtract(s)).subtract(this.y);return new t.PointFp(this.curve,s,n)},t.PointFp.prototype.multiply2D=function(t){if(this.isInfinity())return this;if(0==t.signum())return this.curve.getInfinity();var e,r=t,i=r.multiply(new w("3")),s=this.negate(),n=this;for(e=i.bitLength()-2;e>0;--e){n=n.twice();var o=i.testBit(e);o!=r.testBit(e)&&(n=n.add2D(o?this:s))}return n},t.PointFp.prototype.isOnCurve=function(){var t=this.getX().toBigInteger(),e=this.getY().toBigInteger(),r=this.curve.getA().toBigInteger(),i=this.curve.getB().toBigInteger(),s=this.curve.getQ(),n=e.multiply(e).mod(s),o=t.multiply(t).multiply(t).add(r.multiply(t)).add(i).mod(s);return n.equals(o)},t.PointFp.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"},t.PointFp.prototype.validate=function(){var t=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var e=this.getX().toBigInteger(),r=this.getY().toBigInteger();if(e.compareTo(w.ONE)<0||e.compareTo(t.subtract(w.ONE))>0)throw new Error("x coordinate out of bounds");if(r.compareTo(w.ONE)<0||r.compareTo(t.subtract(w.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(t).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0},t.CurveFp=function(e,r,i){this.q=e,this.a=this.fromBigInteger(r),this.b=this.fromBigInteger(i),this.infinity=new t.PointFp(this,null,null),this.reducer=new pt(this.q)},t.CurveFp.prototype.getQ=function(){return this.q},t.CurveFp.prototype.getA=function(){return this.a},t.CurveFp.prototype.getB=function(){return this.b},t.CurveFp.prototype.equals=function(t){return t==this||this.q.equals(t.q)&&this.a.equals(t.a)&&this.b.equals(t.b)},t.CurveFp.prototype.getInfinity=function(){return this.infinity},t.CurveFp.prototype.fromBigInteger=function(e){return new t.FieldElementFp(this.q,e)},t.CurveFp.prototype.reduce=function(t){this.reducer.reduce(t)},t.CurveFp.prototype.decodePointHex=function(e){var r=parseInt(e.substr(0,2),16);switch(r){case 0:return this.infinity;case 2:case 3:var i=1&r,s=new w(o=e.substr(2,e.length-2),16);return this.decompressPoint(i,s);case 4:case 6:case 7:var n=(e.length-2)/2,o=e.substr(2,n),u=e.substr(n+2,n);return new t.PointFp(this,this.fromBigInteger(new w(o,16)),this.fromBigInteger(new w(u,16)));default:return null}},t.CurveFp.prototype.encodePointHex=function(t){if(t.isInfinity())return"00";var e=t.getX().toBigInteger().toString(16),r=t.getY().toBigInteger().toString(16),i=this.getQ().toString(16).length;for(i%2!=0&&i++;e.length<i;)e="0"+e;for(;r.length<i;)r="0"+r;return"04"+e+r},t.CurveFp.prototype.decompressPoint=function(e,r){var i=this.fromBigInteger(r),s=i.multiply(i.square().add(this.getA())).add(this.getB()).sqrt();if(null==s)throw new Error("Invalid point compression");var n=s.toBigInteger();return(n.testBit(0)?1:0)!=e&&(s=this.fromBigInteger(this.getQ().subtract(n))),new t.PointFp(this,i,s,null,!0)},t.fromHex=function(t){return new w(t,16)},t.integerToBytes=function(t,e){var r=t.toByteArrayUnsigned();if(e<r.length)r=r.slice(r.length-e);else for(;e>r.length;)r.unshift(0);return r},t.X9Parameters=function(t,e,r,i){this.curve=t,this.g=e,this.n=r,this.h=i},t.X9Parameters.prototype.getCurve=function(){return this.curve},t.X9Parameters.prototype.getG=function(){return this.g},t.X9Parameters.prototype.getN=function(){return this.n},t.X9Parameters.prototype.getH=function(){return this.h},t.secNamedCurves={secp256k1:function(){var e=t.fromHex("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F"),r=w.ZERO,i=t.fromHex("7"),s=t.fromHex("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141"),n=w.ONE,o=new t.CurveFp(e,r,i),u=o.decodePointHex("0479BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8");return new t.X9Parameters(o,u,s,n)}},t.getSECCurveByName=function(e){return void 0==t.secNamedCurves[e]?null:t.secNamedCurves[e]()};function w(t,e,r){if(!(this instanceof w))return new w(t,e,r);null!=t&&("number"==typeof t?this.fromNumber(t,e,r):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}var F=w.prototype;function C(){return new w(null)}w.prototype.am=function(t,e,r,i,s,n){for(;--n>=0;){var o=e*this[t++]+r[i]+s;s=Math.floor(o/67108864),r[i++]=67108863&o}return s},e=26,w.prototype.DB=e,w.prototype.DM=67108863;var k=w.prototype.DV=1<<e;w.prototype.FV=Math.pow(2,52),w.prototype.F1=26,w.prototype.F2=0;var S,A,E,H,I,O,D,M,P,_,R,N,z,L,U,V,X,Z,j,G,Y,K="0123456789abcdefghijklmnopqrstuvwxyz",W=new Array;for(S="0".charCodeAt(0),A=0;A<=9;++A)W[S++]=A;for(S="a".charCodeAt(0),A=10;A<36;++A)W[S++]=A;for(S="A".charCodeAt(0),A=10;A<36;++A)W[S++]=A;function Q(t){return K.charAt(t)}function J(t,e){var r=W[t.charCodeAt(e)];return null==r?-1:r}function $(t){var e=C();return e.fromInt(t),e}function tt(t){var e,r=1;return 0!=(e=t>>>16)&&(t=e,r+=16),0!=(e=t>>8)&&(t=e,r+=8),0!=(e=t>>4)&&(t=e,r+=4),0!=(e=t>>2)&&(t=e,r+=2),0!=(e=t>>1)&&(t=e,r+=1),r}function et(t){this.m=t}function rt(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function C(){return new w(null)}function it(t,e){return t&e}function st(t,e){return t|e}function nt(t,e){return t^e}function ot(t,e){return t&~e}function ut(t){if(0==t)return-1;var e=0;return 0==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e}function ht(t){for(var e=0;0!=t;)t&=t-1,++e;return e}function ct(){}function at(t){return t}function pt(t){this.r2=C(),this.q3=C(),w.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}et.prototype.convert=function(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t},et.prototype.revert=function(t){return t},et.prototype.reduce=function(t){t.divRemTo(this.m,null,t)},et.prototype.mulTo=function(t,e,r){t.multiplyTo(e,r),this.reduce(r)},et.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},rt.prototype.convert=function(t){var e=C();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(w.ZERO)>0&&this.m.subTo(e,e),e},rt.prototype.revert=function(t){var e=C();return t.copyTo(e),this.reduce(e),e},rt.prototype.reduce=function(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=32767&t[e],i=r*this.mpl+((r*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(t[r=e+this.m.t]+=this.m.am(0,i,t,e,0,this.m.t);t[r]>=t.DV;)t[r]-=t.DV,t[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)},rt.prototype.mulTo=function(t,e,r){t.multiplyTo(e,r),this.reduce(r)},rt.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},F.copyTo=function(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s},F.fromInt=function(t){this.t=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+k:this.t=0},F.fromString=function(t,e){var r,i=this;if(16==e)r=4;else if(8==e)r=3;else if(256==e)r=8;else if(2==e)r=1;else if(32==e)r=5;else{if(4!=e)return void i.fromRadix(t,e);r=2}i.t=0,i.s=0;for(var s=t.length,n=!1,o=0;--s>=0;){var u=8==r?255&t[s]:J(t,s);u<0?"-"==t.charAt(s)&&(n=!0):(n=!1,0==o?i[i.t++]=u:o+r>i.DB?(i[i.t-1]|=(u&(1<<i.DB-o)-1)<<o,i[i.t++]=u>>i.DB-o):i[i.t-1]|=u<<o,(o+=r)>=i.DB&&(o-=i.DB))}8==r&&0!=(128&t[0])&&(i.s=-1,o>0&&(i[i.t-1]|=(1<<i.DB-o)-1<<o)),i.clamp(),n&&w.ZERO.subTo(i,i)},F.clamp=function(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t},F.dlShiftTo=function(t,e){var r;for(r=this.t-1;r>=0;--r)e[r+t]=this[r];for(r=t-1;r>=0;--r)e[r]=0;e.t=this.t+t,e.s=this.s},F.drShiftTo=function(t,e){for(var r=t;r<this.t;++r)e[r-t]=this[r];e.t=Math.max(this.t-t,0),e.s=this.s},F.lShiftTo=function(t,e){var r,i=this,s=t%i.DB,n=i.DB-s,o=(1<<n)-1,u=Math.floor(t/i.DB),h=i.s<<s&i.DM;for(r=i.t-1;r>=0;--r)e[r+u+1]=i[r]>>n|h,h=(i[r]&o)<<s;for(r=u-1;r>=0;--r)e[r]=0;e[u]=h,e.t=i.t+u+1,e.s=i.s,e.clamp()},F.rShiftTo=function(t,e){var r=this;e.s=r.s;var i=Math.floor(t/r.DB);if(i>=r.t)e.t=0;else{var s=t%r.DB,n=r.DB-s,o=(1<<s)-1;e[0]=r[i]>>s;for(var u=i+1;u<r.t;++u)e[u-i-1]|=(r[u]&o)<<n,e[u-i]=r[u]>>s;s>0&&(e[r.t-i-1]|=(r.s&o)<<n),e.t=r.t-i,e.clamp()}},F.subTo=function(t,e){for(var r=this,i=0,s=0,n=Math.min(t.t,r.t);i<n;)s+=r[i]-t[i],e[i++]=s&r.DM,s>>=r.DB;if(t.t<r.t){for(s-=t.s;i<r.t;)s+=r[i],e[i++]=s&r.DM,s>>=r.DB;s+=r.s}else{for(s+=r.s;i<t.t;)s-=t[i],e[i++]=s&r.DM,s>>=r.DB;s-=t.s}e.s=s<0?-1:0,s<-1?e[i++]=r.DV+s:s>0&&(e[i++]=s),e.t=i,e.clamp()},F.multiplyTo=function(t,e){var r=this.abs(),i=t.abs(),s=r.t;for(e.t=s+i.t;--s>=0;)e[s]=0;for(s=0;s<i.t;++s)e[s+r.t]=r.am(0,i[s],e,s,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&w.ZERO.subTo(e,e)},F.squareTo=function(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t[r]=0;for(r=0;r<e.t-1;++r){var i=e.am(r,e[r],t,2*r,0,1);(t[r+e.t]+=e.am(r+1,2*e[r],t,2*r+1,i,e.t-r-1))>=e.DV&&(t[r+e.t]-=e.DV,t[r+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(r,e[r],t,2*r,0,1)),t.s=0,t.clamp()},F.divRemTo=function(t,e,r){var i=this,s=t.abs();if(!(s.t<=0)){var n=i.abs();if(n.t<s.t)return null!=e&&e.fromInt(0),void(null!=r&&i.copyTo(r));null==r&&(r=C());var o=C(),u=i.s,h=t.s,c=i.DB-tt(s[s.t-1]);c>0?(s.lShiftTo(c,o),n.lShiftTo(c,r)):(s.copyTo(o),n.copyTo(r));var a=o.t,p=o[a-1];if(0!=p){var f=p*(1<<i.F1)+(a>1?o[a-2]>>i.F2:0),l=i.FV/f,y=(1<<i.F1)/f,d=1<<i.F2,g=r.t,v=g-a,m=null==e?C():e;for(o.dlShiftTo(v,m),r.compareTo(m)>=0&&(r[r.t++]=1,r.subTo(m,r)),w.ONE.dlShiftTo(a,m),m.subTo(o,o);o.t<a;)o[o.t++]=0;for(;--v>=0;){var b=r[--g]==p?i.DM:Math.floor(r[g]*l+(r[g-1]+d)*y);if((r[g]+=o.am(0,b,r,v,0,a))<b)for(o.dlShiftTo(v,m),r.subTo(m,r);r[g]<--b;)r.subTo(m,r)}null!=e&&(r.drShiftTo(a,e),u!=h&&w.ZERO.subTo(e,e)),r.t=a,r.clamp(),c>0&&r.rShiftTo(c,r),u<0&&w.ZERO.subTo(r,r)}}},F.invDigit=function(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return(e=(e=(e=(e=e*(2-(15&t)*e)&15)*(2-(255&t)*e)&255)*(2-((65535&t)*e&65535))&65535)*(2-t*e%this.DV)%this.DV)>0?this.DV-e:-e},F.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},F.exp=function(t,e){if(t>4294967295||t<1)return w.ONE;var r=C(),i=C(),s=e.convert(this),n=tt(t)-1;for(s.copyTo(r);--n>=0;)if(e.sqrTo(r,i),(t&1<<n)>0)e.mulTo(i,s,r);else{var o=r;r=i,i=o}return e.revert(r)},F.toString=function(t){var e,r=this;if(r.s<0)return"-"+r.negate().toString(t);if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return r.toRadix(t);e=2}var i,s=(1<<e)-1,n=!1,o="",u=r.t,h=r.DB-u*r.DB%e;if(u-- >0)for(h<r.DB&&(i=r[u]>>h)>0&&(n=!0,o=Q(i));u>=0;)h<e?(i=(r[u]&(1<<h)-1)<<e-h,i|=r[--u]>>(h+=r.DB-e)):(i=r[u]>>(h-=e)&s,h<=0&&(h+=r.DB,--u)),i>0&&(n=!0),n&&(o+=Q(i));return n?o:"0"},F.negate=function(){var t=C();return w.ZERO.subTo(this,t),t},F.abs=function(){return this.s<0?this.negate():this},F.compareTo=function(t){var e=this.s-t.s;if(0!=e)return e;var r=this.t;if(0!=(e=r-t.t))return this.s<0?-e:e;for(;--r>=0;)if(0!=(e=this[r]-t[r]))return e;return 0},F.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+tt(this[this.t-1]^this.s&this.DM)},F.mod=function(t){var e=C();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(w.ZERO)>0&&t.subTo(e,e),e},F.modPowInt=function(t,e){var r;return r=t<256||e.isEven()?new et(e):new rt(e),this.exp(t,r)},ct.prototype.convert=at,ct.prototype.revert=at,ct.prototype.mulTo=function(t,e,r){t.multiplyTo(e,r)},ct.prototype.sqrTo=function(t,e){t.squareTo(e)},pt.prototype.convert=function(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=C();return t.copyTo(e),this.reduce(e),e},pt.prototype.revert=function(t){return t},pt.prototype.reduce=function(t){var e=this;for(t.drShiftTo(e.m.t-1,e.r2),t.t>e.m.t+1&&(t.t=e.m.t+1,t.clamp()),e.mu.multiplyUpperTo(e.r2,e.m.t+1,e.q3),e.m.multiplyLowerTo(e.q3,e.m.t+1,e.r2);t.compareTo(e.r2)<0;)t.dAddOffset(1,e.m.t+1);for(t.subTo(e.r2,t);t.compareTo(e.m)>=0;)t.subTo(e.m,t)},pt.prototype.mulTo=function(t,e,r){t.multiplyTo(e,r),this.reduce(r)},pt.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},F.chunkSize=function(t){return Math.floor(Math.LN2*this.DB/Math.log(t))},F.toRadix=function(t){if(null==t&&(t=10),0==this.signum()||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),i=$(r),s=C(),n=C(),o="";for(this.divRemTo(i,s,n);s.signum()>0;)o=(r+n.intValue()).toString(t).substr(1)+o,s.divRemTo(i,s,n);return n.intValue().toString(t)+o},F.fromRadix=function(t,e){var r=this;r.fromInt(0),null==e&&(e=10);for(var i=r.chunkSize(e),s=Math.pow(e,i),n=!1,o=0,u=0,h=0;h<t.length;++h){var c=J(t,h);c<0?"-"==t.charAt(h)&&0==r.signum()&&(n=!0):(u=e*u+c,++o>=i&&(r.dMultiply(s),r.dAddOffset(u,0),o=0,u=0))}o>0&&(r.dMultiply(Math.pow(e,o)),r.dAddOffset(u,0)),n&&w.ZERO.subTo(r,r)},F.fromNumber=function(t,e,r){var i=this;if("number"==typeof e)if(t<2)i.fromInt(1);else for(i.fromNumber(t,r),i.testBit(t-1)||i.bitwiseTo(w.ONE.shiftLeft(t-1),st,i),i.isEven()&&i.dAddOffset(1,0);!i.isProbablePrime(e);)i.dAddOffset(2,0),i.bitLength()>t&&i.subTo(w.ONE.shiftLeft(t-1),i);else{var s=new Array,n=7&t;s.length=1+(t>>3),e.nextBytes(s),n>0?s[0]&=(1<<n)-1:s[0]=0,i.fromString(s,256)}},F.bitwiseTo=function(t,e,r){var i,s,n=this,o=Math.min(t.t,n.t);for(i=0;i<o;++i)r[i]=e(n[i],t[i]);if(t.t<n.t){for(s=t.s&n.DM,i=o;i<n.t;++i)r[i]=e(n[i],s);r.t=n.t}else{for(s=n.s&n.DM,i=o;i<t.t;++i)r[i]=e(s,t[i]);r.t=t.t}r.s=e(n.s,t.s),r.clamp()},F.changeBit=function(t,e){var r=w.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r},F.addTo=function(t,e){for(var r=this,i=0,s=0,n=Math.min(t.t,r.t);i<n;)s+=r[i]+t[i],e[i++]=s&r.DM,s>>=r.DB;if(t.t<r.t){for(s+=t.s;i<r.t;)s+=r[i],e[i++]=s&r.DM,s>>=r.DB;s+=r.s}else{for(s+=r.s;i<t.t;)s+=t[i],e[i++]=s&r.DM,s>>=r.DB;s+=t.s}e.s=s<0?-1:0,s>0?e[i++]=s:s<-1&&(e[i++]=r.DV+s),e.t=i,e.clamp()},F.dMultiply=function(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()},F.dAddOffset=function(t,e){if(0!=t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}},F.multiplyLowerTo=function(t,e,r){var i,s=Math.min(this.t+t.t,e);for(r.s=0,r.t=s;s>0;)r[--s]=0;for(i=r.t-this.t;s<i;++s)r[s+this.t]=this.am(0,t[s],r,s,0,this.t);for(i=Math.min(t.t,e);s<i;++s)this.am(0,t[s],r,s,0,e-s);r.clamp()},F.multiplyUpperTo=function(t,e,r){--e;var i=r.t=this.t+t.t-e;for(r.s=0;--i>=0;)r[i]=0;for(i=Math.max(e-this.t,0);i<t.t;++i)r[this.t+i-e]=this.am(e-i,t[i],r,0,0,this.t+i-e);r.clamp(),r.drShiftTo(1,r)},F.modInt=function(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(0==e)r=this[0]%t;else for(var i=this.t-1;i>=0;--i)r=(e*r+this[i])%t;return r},F.clone=function(){var t=C();return this.copyTo(t),t},F.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},F.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},F.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},F.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},F.toByteArray=function(){var t=this,e=t.t,r=new Array;r[0]=t.s;var i,s=t.DB-e*t.DB%8,n=0;if(e-- >0)for(s<t.DB&&(i=t[e]>>s)!=(t.s&t.DM)>>s&&(r[n++]=i|t.s<<t.DB-s);e>=0;)s<8?(i=(t[e]&(1<<s)-1)<<8-s,i|=t[--e]>>(s+=t.DB-8)):(i=t[e]>>(s-=8)&255,s<=0&&(s+=t.DB,--e)),0!=(128&i)&&(i|=-256),0===n&&(128&t.s)!=(128&i)&&++n,(n>0||i!=t.s)&&(r[n++]=i);return r},F.equals=function(t){return 0==this.compareTo(t)},F.min=function(t){return this.compareTo(t)<0?this:t},F.max=function(t){return this.compareTo(t)>0?this:t},F.and=function(t){var e=C();return this.bitwiseTo(t,it,e),e},F.or=function(t){var e=C();return this.bitwiseTo(t,st,e),e},F.xor=function(t){var e=C();return this.bitwiseTo(t,nt,e),e},F.andNot=function(t){var e=C();return this.bitwiseTo(t,ot,e),e},F.not=function(){for(var t=C(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t},F.shiftLeft=function(t){var e=C();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e},F.shiftRight=function(t){var e=C();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e},F.getLowestSetBit=function(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+ut(this[t]);return this.s<0?this.t*this.DB:-1},F.bitCount=function(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=ht(this[r]^e);return t},F.testBit=function(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this[e]&1<<t%this.DB)},F.setBit=function(t){return this.changeBit(t,st)},F.clearBit=function(t){return this.changeBit(t,ot)},F.flipBit=function(t){return this.changeBit(t,nt)},F.add=function(t){var e=C();return this.addTo(t,e),e},F.subtract=function(t){var e=C();return this.subTo(t,e),e},F.multiply=function(t){var e=C();return this.multiplyTo(t,e),e},F.divide=function(t){var e=C();return this.divRemTo(t,e,null),e},F.remainder=function(t){var e=C();return this.divRemTo(t,null,e),e},F.divideAndRemainder=function(t){var e=C(),r=C();return this.divRemTo(t,e,r),new Array(e,r)},F.modPow=function(t,e){var r,i,s=t.bitLength(),n=$(1);if(s<=0)return n;r=s<18?1:s<48?3:s<144?4:s<768?5:6,i=s<8?new et(e):e.isEven()?new pt(e):new rt(e);var o=new Array,u=3,h=r-1,c=(1<<r)-1;if(o[1]=i.convert(this),r>1){var a=C();for(i.sqrTo(o[1],a);u<=c;)o[u]=C(),i.mulTo(a,o[u-2],o[u]),u+=2}var p,f,l=t.t-1,y=!0,d=C();for(s=tt(t[l])-1;l>=0;){for(s>=h?p=t[l]>>s-h&c:(p=(t[l]&(1<<s+1)-1)<<h-s,l>0&&(p|=t[l-1]>>this.DB+s-h)),u=r;0==(1&p);)p>>=1,--u;if((s-=u)<0&&(s+=this.DB,--l),y)o[p].copyTo(n),y=!1;else{for(;u>1;)i.sqrTo(n,d),i.sqrTo(d,n),u-=2;u>0?i.sqrTo(n,d):(f=n,n=d,d=f),i.mulTo(d,o[p],n)}for(;l>=0&&0==(t[l]&1<<s);)i.sqrTo(n,d),f=n,n=d,d=f,--s<0&&(s=this.DB-1,--l)}return i.revert(n)},F.modInverse=function(t){var e=t.isEven();if(this.isEven()&&e||0==t.signum())return w.ZERO;for(var r=t.clone(),i=this.clone(),s=$(1),n=$(0),o=$(0),u=$(1);0!=r.signum();){for(;r.isEven();)r.rShiftTo(1,r),e?(s.isEven()&&n.isEven()||(s.addTo(this,s),n.subTo(t,n)),s.rShiftTo(1,s)):n.isEven()||n.subTo(t,n),n.rShiftTo(1,n);for(;i.isEven();)i.rShiftTo(1,i),e?(o.isEven()&&u.isEven()||(o.addTo(this,o),u.subTo(t,u)),o.rShiftTo(1,o)):u.isEven()||u.subTo(t,u),u.rShiftTo(1,u);r.compareTo(i)>=0?(r.subTo(i,r),e&&s.subTo(o,s),n.subTo(u,n)):(i.subTo(r,i),e&&o.subTo(s,o),u.subTo(n,u))}return 0!=i.compareTo(w.ONE)?w.ZERO:u.compareTo(t)>=0?u.subtract(t):u.signum()<0?(u.addTo(t,u),u.signum()<0?u.add(t):u):u},F.pow=function(t){return this.exp(t,new ct)},F.gcd=function(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var i=e;e=r,r=i}var s=e.getLowestSetBit(),n=r.getLowestSetBit();if(n<0)return e;for(s<n&&(n=s),n>0&&(e.rShiftTo(n,e),r.rShiftTo(n,r));e.signum()>0;)(s=e.getLowestSetBit())>0&&e.rShiftTo(s,e),(s=r.getLowestSetBit())>0&&r.rShiftTo(s,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return n>0&&r.lShiftTo(n,r),r},F.square=function(){var t=C();return this.squareTo(t),t},w.ZERO=$(0),w.ONE=$(1),w.valueOf=$,w.fromByteArrayUnsigned=function(t){return t.length?128&t[0]?new w([0].concat(t)):new w(t):new w.valueOf(0)},w.fromByteArraySigned=function(t){return 128&t[0]?(t[0]&=127,w.fromByteArrayUnsigned(t).negate()):w.fromByteArrayUnsigned(t)},w.prototype.toByteArrayUnsigned=function(){var t=this.abs().toByteArray();if(!t.length)return t;0===t[0]&&(t=t.slice(1));for(var e=0;e<t.length;++e)t[e]=t[e]<0?t[e]+256:t[e];return t},w.prototype.toByteArraySigned=function(){var t=this.toByteArrayUnsigned(),e=this.s<0;return 128&t[0]?t.unshift(e?128:0):e&&(t[0]|=128),t},function(){var t,e=(t=window.Crypto={}).util={rotl:function(t,e){return t<<e|t>>>32-e},rotr:function(t,e){return t<<32-e|t>>>e},endian:function(t){if(t.constructor==Number)return 16711935&e.rotl(t,8)|4278255360&e.rotl(t,24);for(var r=0;r<t.length;r++)t[r]=e.endian(t[r]);return t},randomBytes:function(t){for(var e=[];t>0;t--)e.push(Math.floor(256*Math.random()));return e},bytesToWords:function(t){for(var e=[],r=0,i=0;r<t.length;r++,i+=8)e[i>>>5]|=(255&t[r])<<24-i%32;return e},wordsToBytes:function(t){for(var e=[],r=0;r<32*t.length;r+=8)e.push(t[r>>>5]>>>24-r%32&255);return e},bytesToHex:function(t){for(var e=[],r=0;r<t.length;r++)e.push((t[r]>>>4).toString(16)),e.push((15&t[r]).toString(16));return e.join("")},hexToBytes:function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(parseInt(t.substr(r,2),16));return e},bytesToBase64:function(t){for(var e=[],r=0;r<t.length;r+=3)for(var i=t[r]<<16|t[r+1]<<8|t[r+2],s=0;s<4;s++)8*r+6*s<=8*t.length?e.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(i>>>6*(3-s)&63)):e.push("=");return e.join("")},base64ToBytes:function(t){t=t.replace(/[^A-Z0-9+\/]/gi,"");for(var e=[],r=0,i=0;r<t.length;i=++r%4)0!=i&&e.push(("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(t.charAt(r-1))&Math.pow(2,-2*i+8)-1)<<2*i|"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(t.charAt(r))>>>6-2*i);return e}};(t=t.charenc={}).UTF8={stringToBytes:function(t){return r.stringToBytes(unescape(encodeURIComponent(t)))},bytesToString:function(t){return decodeURIComponent(escape(r.bytesToString(t)))}};var r=t.Binary={stringToBytes:function(t){for(var e=[],r=0;r<t.length;r++)e.push(255&t.charCodeAt(r));return e},bytesToString:function(t){for(var e=[],r=0;r<t.length;r++)e.push(String.fromCharCode(t[r]));return e.join("")}}}(),E=Crypto,H=E.util,I=E.charenc,O=I.UTF8,D=I.Binary,M=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],(P=E.SHA256=function(t,e){var r=H.wordsToBytes(P._sha256(t));return e&&e.asBytes?r:e&&e.asString?D.bytesToString(r):H.bytesToHex(r)})._sha256=function(t){t.constructor==String&&(t=O.stringToBytes(t));var e,r,i,s,n,o,u,h,c,a,p,f=H.bytesToWords(t),l=8*t.length,y=(t=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],[]);for(f[l>>5]|=128<<24-l%32,f[15+(l+64>>9<<4)]=l,h=0;h<f.length;h+=16){for(l=t[0],e=t[1],r=t[2],i=t[3],s=t[4],n=t[5],o=t[6],u=t[7],c=0;c<64;c++){c<16?y[c]=f[c+h]:(a=y[c-15],p=y[c-2],y[c]=((a<<25|a>>>7)^(a<<14|a>>>18)^a>>>3)+(y[c-7]>>>0)+((p<<15|p>>>17)^(p<<13|p>>>19)^p>>>10)+(y[c-16]>>>0)),p=l&e^l&r^e&r;var d=(l<<30|l>>>2)^(l<<19|l>>>13)^(l<<10|l>>>22);a=(u>>>0)+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&n^~s&o)+M[c]+(y[c]>>>0),u=o,o=n,n=s,s=i+a>>>0,i=r,r=e,e=l,l=a+(p=d+p)>>>0}t[0]+=l,t[1]+=e,t[2]+=r,t[3]+=i,t[4]+=s,t[5]+=n,t[6]+=o,t[7]+=u}return t},P._blocksize=16,P._digestsize=32,("undefined"==typeof Crypto||!Crypto.util)&&function(){var t,e=(t=window.Crypto={}).util={rotl:function(t,e){return t<<e|t>>>32-e},rotr:function(t,e){return t<<32-e|t>>>e},endian:function(t){if(t.constructor==Number)return 16711935&e.rotl(t,8)|4278255360&e.rotl(t,24);for(var r=0;r<t.length;r++)t[r]=e.endian(t[r]);return t},randomBytes:function(t){for(var e=[];t>0;t--)e.push(Math.floor(256*Math.random()));return e},bytesToWords:function(t){for(var e=[],r=0,i=0;r<t.length;r++,i+=8)e[i>>>5]|=(255&t[r])<<24-i%32;return e},wordsToBytes:function(t){for(var e=[],r=0;r<32*t.length;r+=8)e.push(t[r>>>5]>>>24-r%32&255);return e},bytesToHex:function(t){for(var e=[],r=0;r<t.length;r++)e.push((t[r]>>>4).toString(16)),e.push((15&t[r]).toString(16));return e.join("")},hexToBytes:function(t){for(var e=[],r=0;r<t.length;r+=2)e.push(parseInt(t.substr(r,2),16));return e},bytesToBase64:function(t){for(var e=[],r=0;r<t.length;r+=3)for(var i=t[r]<<16|t[r+1]<<8|t[r+2],s=0;s<4;s++)8*r+6*s<=8*t.length?e.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(i>>>6*(3-s)&63)):e.push("=");return e.join("")},base64ToBytes:function(t){t=t.replace(/[^A-Z0-9+\/]/gi,"");for(var e=[],r=0,i=0;r<t.length;i=++r%4)0!=i&&e.push(("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(t.charAt(r-1))&Math.pow(2,-2*i+8)-1)<<2*i|"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(t.charAt(r))>>>6-2*i);return e}};(t=t.charenc={}).UTF8={stringToBytes:function(t){return r.stringToBytes(unescape(encodeURIComponent(t)))},bytesToString:function(t){return decodeURIComponent(escape(r.bytesToString(t)))}};var r=t.Binary={stringToBytes:function(t){for(var e=[],r=0;r<t.length;r++)e.push(255&t.charCodeAt(r));return e},bytesToString:function(t){for(var e=[],r=0;r<t.length;r++)e.push(String.fromCharCode(t[r]));return e.join("")}}}(),_=Crypto,R=_.util,N=_.charenc,z=N.UTF8,L=N.Binary,U=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],(V=_.SHA256=function(t,e){var r=R.wordsToBytes(V._sha256(t));return e&&e.asBytes?r:e&&e.asString?L.bytesToString(r):R.bytesToHex(r)})._sha256=function(t){t.constructor==String&&(t=z.stringToBytes(t));var e,r,i,s,n,o,u,h,c,a,p,f=R.bytesToWords(t),l=8*t.length,y=(t=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],[]);for(f[l>>5]|=128<<24-l%32,f[15+(l+64>>9<<4)]=l,h=0;h<f.length;h+=16){for(l=t[0],e=t[1],r=t[2],i=t[3],s=t[4],n=t[5],o=t[6],u=t[7],c=0;c<64;c++){c<16?y[c]=f[c+h]:(a=y[c-15],p=y[c-2],y[c]=((a<<25|a>>>7)^(a<<14|a>>>18)^a>>>3)+(y[c-7]>>>0)+((p<<15|p>>>17)^(p<<13|p>>>19)^p>>>10)+(y[c-16]>>>0)),p=l&e^l&r^e&r;var d=(l<<30|l>>>2)^(l<<19|l>>>13)^(l<<10|l>>>22);a=(u>>>0)+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&n^~s&o)+U[c]+(y[c]>>>0),u=o,o=n,n=s,s=i+a>>>0,i=r,r=e,e=l,l=a+(p=d+p)>>>0}t[0]+=l,t[1]+=e,t[2]+=r,t[3]+=i,t[4]+=s,t[5]+=n,t[6]+=o,t[7]+=u}return t},V._blocksize=16,V._digestsize=32,X=Crypto,Z=X.util,j=X.charenc,G=j.UTF8,Y=j.Binary,X.HMAC=function(t,e,r,i){e.constructor==String&&(e=G.stringToBytes(e)),r.constructor==String&&(r=G.stringToBytes(r)),r.length>4*t._blocksize&&(r=t(r,{asBytes:!0}));for(var s=r.slice(0),n=(r=r.slice(0),0);n<4*t._blocksize;n++)s[n]^=92,r[n]^=54;return t=t(s.concat(t(r.concat(e),{asBytes:!0})),{asBytes:!0}),i&&i.asBytes?t:i&&i.asString?Y.bytesToString(t):Z.bytesToHex(t)};var ft=window.coinjs=function(){};return ft.priv=128,ft.pub=26,ft.multisig=51,ft.hdkey={prv:76066276,pub:76067358},ft.bech32={charset:"qpzry9x8gf2tvdw0s3jn54khce6mua7l",version:0,hrp:"bc"},forkid=96,ft.compressed=!0,ft.host="https://volbil.com/mbc/api/",ft.uid="1",ft.key="12345678901234567890123456789012",ft.newKeys=function(t){var e=t?Crypto.SHA256(t):this.newPrivkey(),r=this.newPubkey(e);return{privkey:e,pubkey:r,address:this.pubkey2address(r),wif:this.privkey2wif(e),compressed:this.compressed}},ft.newPrivkey=function(){var t=window.location;t+=window.screen.height*window.screen.width*window.screen.colorDepth,t+=ft.random(64),t+=window.screen.availHeight*window.screen.availWidth*window.screen.pixelDepth,t+=navigator.language,t+=window.history.length,t+=ft.random(64),t+=navigator.userAgent,t+="coinb.in",t+=Crypto.util.randomBytes(64).join(""),t+=t.length,t+=(new Date).getTimezoneOffset(),t+=ft.random(64),t+=document.getElementById("entropybucket")?document.getElementById("entropybucket").innerHTML:"";var e=t+=t+""+t;for(i=0;i<t.length/25;i++)e=Crypto.SHA256(e.concat(t));for(var r=new w(e),s=new w("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141");r.compareTo(s)>=0||r.equals(w.ZERO)||r.equals(w.ONE);)r=new w(e=Crypto.SHA256(e.concat(t)));return e},ft.newPubkey=function(t){var e=w.fromByteArrayUnsigned(Crypto.util.hexToBytes(t)),r=EllipticCurve.getSECCurveByName("secp256k1").getG().multiply(e),i=r.getX().toBigInteger(),s=r.getY().toBigInteger(),n=EllipticCurve.integerToBytes(i,32);if((n=n.concat(EllipticCurve.integerToBytes(s,32))).unshift(4),1==ft.compressed){var o=EllipticCurve.integerToBytes(i,32);return s.isEven()?o.unshift(2):o.unshift(3),Crypto.util.bytesToHex(o)}return Crypto.util.bytesToHex(n)},ft.pubkey2address=function(t,e){var r=T(Crypto.SHA256(Crypto.util.hexToBytes(t),{asBytes:!0}));r.unshift(e||ft.pub);var i=Crypto.SHA256(Crypto.SHA256(r,{asBytes:!0}),{asBytes:!0}).slice(0,4);return ft.base58encode(r.concat(i))},ft.scripthash2address=function(t){var e=Crypto.util.hexToBytes(t);e.unshift(ft.pub);var r=e,i=(r=Crypto.SHA256(Crypto.SHA256(r,{asBytes:!0}),{asBytes:!0})).slice(0,4);return ft.base58encode(e.concat(i))},ft.pubkeys2MultisigAddress=function(t,e){var r=ft.script();r.writeOp(81+1*e-1);for(var i=0;i<t.length;++i)r.writeBytes(Crypto.util.hexToBytes(t[i]));r.writeOp(81+t.length-1),r.writeOp(174);var s=T(Crypto.SHA256(r.buffer,{asBytes:!0}));s.unshift(ft.multisig);var n=s,o=(n=Crypto.SHA256(Crypto.SHA256(n,{asBytes:!0}),{asBytes:!0})).slice(0,4),u=Crypto.util.bytesToHex(r.buffer),h=ft.base58encode(s.concat(o));return r.buffer.length>520&&(h="invalid",u="invalid"),{address:h,redeemScript:u,size:r.buffer.length}},ft.simpleHodlAddress=function(t,e){if(e<0)throw"Parameter for OP_CHECKLOCKTIMEVERIFY is negative.";var r=ft.script();r.writeBytes(ft.numToByteArray(e)),r.writeOp(177),r.writeOp(117),r.writeBytes(Crypto.util.hexToBytes(t)),r.writeOp(172);var i=T(Crypto.SHA256(r.buffer,{asBytes:!0}));i.unshift(ft.multisig);var s=i,n=(s=Crypto.SHA256(Crypto.SHA256(s,{asBytes:!0}),{asBytes:!0})).slice(0,4),o=Crypto.util.bytesToHex(r.buffer);return{address:ft.base58encode(i.concat(n)),redeemScript:o}},ft.segwitAddress=function(t){var e=[0,20].concat(T(Crypto.SHA256(Crypto.util.hexToBytes(t),{asBytes:!0}))),r=T(Crypto.SHA256(e,{asBytes:!0}));r.unshift(ft.multisig);var i=r,s=(i=Crypto.SHA256(Crypto.SHA256(i,{asBytes:!0}),{asBytes:!0})).slice(0,4);return{address:ft.base58encode(r.concat(s)),type:"segwit",redeemscript:Crypto.util.bytesToHex(e)}},ft.bech32Address=function(t){var e=T(Crypto.SHA256(Crypto.util.hexToBytes(t),{asBytes:!0}));return{address:ft.bech32_encode(ft.bech32.hrp,[ft.bech32.version].concat(ft.bech32_convert(e,8,5,!0))),type:"bech32",redeemscript:Crypto.util.bytesToHex(e)}},ft.bech32redeemscript=function(t){var e=ft.bech32_decode(t);return!!e&&(e.data.shift(),Crypto.util.bytesToHex(ft.bech32_convert(e.data,5,8,!0)))},ft.privkey2wif=function(t){var e=Crypto.util.hexToBytes(t);1==ft.compressed&&e.push(1),e.unshift(ft.priv);var r=Crypto.SHA256(Crypto.SHA256(e,{asBytes:!0}),{asBytes:!0}).slice(0,4);return ft.base58encode(e.concat(r))},ft.wif2privkey=function(t){var e=!1,r=ft.base58decode(t),i=r.slice(0,r.length-4);return(i=i.slice(1,i.length)).length>=33&&1==i[i.length-1]&&(i=i.slice(0,i.length-1),e=!0),{privkey:Crypto.util.bytesToHex(i),compressed:e}},ft.wif2pubkey=function(t){var e=ft.compressed,r=ft.wif2privkey(t);ft.compressed=r.compressed;var i=ft.newPubkey(r.privkey);return ft.compressed=e,{pubkey:i,compressed:r.compressed}},ft.wif2address=function(t){var e=ft.wif2pubkey(t);return{address:ft.pubkey2address(e.pubkey),compressed:e.compressed}},ft.addressDecode=function(t){try{var e=ft.base58decode(t),r=e.slice(0,e.length-4),i=e.slice(e.length-4);if(Crypto.SHA256(Crypto.SHA256(r,{asBytes:!0}),{asBytes:!0}).slice(0,4)+""==i+""){var s={};if(s.bytes=r.slice(1),s.version=r[0],s.version==ft.pub)s.type="standard";else if(s.version==ft.multisig)s.type="multisig";else if(s.version==ft.priv)s.type="wifkey";else if(42==s.version){if(s.type="stealth",s.option=r[1],0!=s.option)return alert("Stealth Address option other than 0 is currently not supported!"),!1;if(s.scankey=Crypto.util.bytesToHex(r.slice(2,35)),s.n=r[35],s.n>1)return alert("Stealth Multisig is currently not supported!"),!1;if(s.spendkey=Crypto.util.bytesToHex(r.slice(36,69)),s.m=r[69],s.prefixlen=r[70],s.prefixlen>0)return alert("Stealth Address Prefixes are currently not supported!"),!1;s.prefix=r.slice(71)}else s.type="other";return s}return!1}catch(e){return bech32rs=ft.bech32redeemscript(t),!!bech32rs&&{type:"bech32",redeemscript:bech32rs}}},ft.addressBalance=function(t,e){ft.ajax(ft.host+"?method=blockchain.address.get_balance&params[]="+t,e,"GET")},ft.pubkeydecompress=function(t){if("string"==typeof t&&t.match(/^[a-f0-9]+$/i)){var e=EllipticCurve.getSECCurveByName("secp256k1");try{var r=e.curve.decodePointHex(t),i=r.getX().toBigInteger(),s=r.getY().toBigInteger(),n=EllipticCurve.integerToBytes(i,32);return(n=n.concat(EllipticCurve.integerToBytes(s,32))).unshift(4),Crypto.util.bytesToHex(n)}catch(t){return!1}}return!1},ft.bech32_polymod=function(t){for(var e=1,r=[996825010,642813549,513874426,1027748829,705979059],i=0;i<t.length;++i){var s=e>>25;e=(33554431&e)<<5^t[i];for(var n=0;n<5;++n)s>>n&1&&(e^=r[n])}return e},ft.bech32_hrpExpand=function(t){var e,r=[];for(e=0;e<t.length;++e)r.push(t.charCodeAt(e)>>5);for(r.push(0),e=0;e<t.length;++e)r.push(31&t.charCodeAt(e));return r},ft.bech32_verifyChecksum=function(t,e){return 1===ft.bech32_polymod(ft.bech32_hrpExpand(t).concat(e))},ft.bech32_createChecksum=function(t,e){for(var r=ft.bech32_hrpExpand(t).concat(e).concat([0,0,0,0,0,0]),i=1^ft.bech32_polymod(r),s=[],n=0;n<6;++n)s.push(i>>5*(5-n)&31);return s},ft.bech32_encode=function(t,e){for(var r=e.concat(ft.bech32_createChecksum(t,e)),i=t+"1",s=0;s<r.length;++s)i+=ft.bech32.charset.charAt(r[s]);return i},ft.bech32_decode=function(t){var e,r=!1,i=!1;for(e=0;e<t.length;++e){if(t.charCodeAt(e)<33||t.charCodeAt(e)>126)return null;t.charCodeAt(e)>=97&&t.charCodeAt(e)<=122&&(r=!0),t.charCodeAt(e)>=65&&t.charCodeAt(e)<=90&&(i=!0)}if(r&&i)return null;var s=(t=t.toLowerCase()).lastIndexOf("1");if(s<1||s+7>t.length||t.length>90)return null;var n=t.substring(0,s),o=[];for(e=s+1;e<t.length;++e){var u=ft.bech32.charset.indexOf(t.charAt(e));if(-1===u)return null;o.push(u)}return ft.bech32_verifyChecksum(n,o)?{hrp:n,data:o.slice(0,o.length-6)}:null},ft.bech32_convert=function(t,e,r,i){for(var s=0,n=0,o=(1<<r)-1,u=[],h=0;h<t.length;++h)for(s=s<<e|t[h],n+=e;n>=r;)n-=r,u.push(s>>n&o);if(i)n>0&&u.push(s<<r-n&o);else{if(n>=e)throw new Error("Excess padding");if(s<<r-n&o)throw new Error("Non-zero padding")}return u},ft.hd=function(t){var e={parse:function(){var r=[];if("string"==typeof t){var i=ft.base58decode(t);if(82==i.length){var s=i.slice(78,82),n=Crypto.SHA256(Crypto.SHA256(i.slice(0,78),{asBytes:!0}),{asBytes:!0});s[0]==n[0]&&s[1]==n[1]&&s[2]==n[2]&&s[3]==n[3]&&(r=i.slice(0,78))}}if(r&&r.length>0){e.version=ft.uint(r.slice(0,4),4),e.depth=ft.uint(r.slice(4,5),1),e.parent_fingerprint=r.slice(5,9),e.child_index=ft.uint(r.slice(9,13),4),e.chain_code=r.slice(13,45),e.key_bytes=r.slice(45,78);var o=ft.compressed;if(ft.compressed=!0,0==e.key_bytes[0]){e.type="private";var u=e.key_bytes.slice(1,33),h=Crypto.util.bytesToHex(u),c=ft.newPubkey(h);e.keys={privkey:h,pubkey:c,address:ft.pubkey2address(c),wif:ft.privkey2wif(h)}}else if(2==e.key_bytes[0]||3==e.key_bytes[0]){e.type="public";var a=Crypto.util.bytesToHex(e.key_bytes);e.keys={pubkey:a,address:ft.pubkey2address(a)}}else e.type="invalid";e.keys_extended=e.extend(),ft.compressed=o}},extend:function(){return ft.hd().make({depth:1*this.depth+1,parent_fingerprint:this.parent_fingerprint,child_index:this.child_index,chain_code:this.chain_code,privkey:this.keys.privkey,pubkey:this.keys.pubkey})},derive:function(t){t=t||0;var r,i,s,n,o=Crypto.util.hexToBytes(this.keys.pubkey).concat(ft.numToBytes(t,4).reverse()),u=new jsSHA(Crypto.util.bytesToHex(o),"HEX").getHMAC(Crypto.util.bytesToHex(e.chain_code),"HEX","SHA-512","HEX"),h=new w(u.slice(0,64),16),c=Crypto.util.hexToBytes(u.slice(64,128)),a=EllipticCurve.getSECCurveByName("secp256k1");a.getCurve();if((n=ft.clone(this)).chain_code=c,n.child_index=t,"private"==this.type)r=h.add(new w([0].concat(Crypto.util.hexToBytes(this.keys.privkey)))).mod(a.getN()),i=Crypto.util.bytesToHex(r.toByteArrayUnsigned()),s=ft.newPubkey(i),n.keys={privkey:i,pubkey:s,wif:ft.privkey2wif(i),address:ft.pubkey2address(s)};else if("public"==this.type){q=a.curve.decodePointHex(this.keys.pubkey);var p=a.getG().multiply(h).add(q),f=p.getX().toBigInteger(),l=p.getY().toBigInteger(),y=EllipticCurve.integerToBytes(f,32);l.isEven()?y.unshift(2):y.unshift(3),s=Crypto.util.bytesToHex(y),n.keys={pubkey:s,address:ft.pubkey2address(s)}}return n.parent_fingerprint=T(Crypto.SHA256(Crypto.util.hexToBytes(e.keys.pubkey),{asBytes:!0})).slice(0,4),n.keys_extended=n.extend(),n},master:function(t){var e=t?Crypto.SHA256(t):ft.newPrivkey(),r=new jsSHA(e,"HEX").getHMAC("Bitcoin seed","TEXT","SHA-512","HEX"),i=(Crypto.util.hexToBytes(r.slice(0,64)),Crypto.util.hexToBytes(r.slice(64,128)));return ft.hd().make({depth:0,parent_fingerprint:[0,0,0,0],child_index:0,chain_code:i,privkey:r.slice(0,64),pubkey:ft.newPubkey(r.slice(0,64))})},make:function(t){var e=[];e.push(1*t.depth),e=(e=(e=e.concat(t.parent_fingerprint)).concat(ft.numToBytes(t.child_index,4).reverse())).concat(t.chain_code);var r={};if(t.privkey){var i=ft.numToBytes(ft.hdkey.prv,4).reverse();(i=i.concat(e)).push(0),i=i.concat(Crypto.util.hexToBytes(t.privkey));var s=Crypto.SHA256(Crypto.SHA256(i,{asBytes:!0}),{asBytes:!0}).slice(0,4),n=i.concat(s);r.privkey=ft.base58encode(n)}if(t.pubkey){var o=ft.numToBytes(ft.hdkey.pub,4).reverse();o=(o=o.concat(e)).concat(Crypto.util.hexToBytes(t.pubkey));s=Crypto.SHA256(Crypto.SHA256(o,{asBytes:!0}),{asBytes:!0}).slice(0,4),n=o.concat(s);r.pubkey=ft.base58encode(n)}return r}};return e.parse(),e},ft.script=function(t){var e={};return t?"string"==typeof t?e.buffer=Crypto.util.hexToBytes(t):ft.isArray(t)?e.buffer=t:t instanceof ft.script?e.buffer=t.buffer:e.buffer=t:e.buffer=[],e.parse=function(){var t=this;e.chunks=[];var r=0;function i(e){t.chunks.push(t.buffer.slice(r,r+e)),r+=e}for(;r<this.buffer.length;){var s=this.buffer[r++];if(s>=240&&(s=s<<8|this.buffer[r++]),s>0&&s<76?i(s):76==s?i(this.buffer[r++]):77==s?i(this.buffer[r++]<<8|this.buffer[r++]):78==s?i(this.buffer[r++]<<24|this.buffer[r++]<<16|this.buffer[r++]<<8|this.buffer[r++]):this.chunks.push(s),r<0)break}return!0},e.decodeRedeemScript=function(t){var e=!1;try{var r=ft.script(Crypto.util.hexToBytes(t));if(r.chunks.length>=3&&174==r.chunks[r.chunks.length-1]){(e={}).signaturesRequired=r.chunks[0]-80;for(var i=[],s=1;s<r.chunks.length-2;s++)i.push(Crypto.util.bytesToHex(r.chunks[s]));e.pubkeys=i;var n=ft.pubkeys2MultisigAddress(i,e.signaturesRequired);e.address=n.address,e.type="multisig__"}else if(2==r.chunks.length&&0==r.buffer[0]&&20==r.buffer[1]){(e={}).type="segwit__";var o=Crypto.util.bytesToHex(r.buffer);e.address=ft.pubkey2address(o,ft.multisig),e.redeemscript=o}else 5==r.chunks.length&&177==r.chunks[1]&&117==r.chunks[2]&&172==r.chunks[4]&&((e={}).pubkey=Crypto.util.bytesToHex(r.chunks[3]),e.checklocktimeverify=ft.bytesToNum(r.chunks[0].slice()),e.address=ft.simpleHodlAddress(e.pubkey,e.checklocktimeverify).address,e.type="hodl__")}catch(t){e=!1}return e},e.spendToScript=function(t){var e=ft.addressDecode(t),r=ft.script();return"bech32"==e.type?(r.writeOp(0),r.writeBytes(Crypto.util.hexToBytes(e.redeemscript))):e.version==ft.multisig?(r.writeOp(169),r.writeBytes(e.bytes),r.writeOp(135)):(r.writeOp(118),r.writeOp(169),r.writeBytes(e.bytes),r.writeOp(136),r.writeOp(172)),r},e.pubkeyHash=function(t){var e=ft.addressDecode(t),r=ft.script();return r.writeOp(118),r.writeOp(169),r.writeBytes(e.bytes),r.writeOp(136),r.writeOp(172),r},e.writeOp=function(t){return this.buffer.push(t),this.chunks.push(t),!0},e.writeBytes=function(t){return t.length<76?this.buffer.push(t.length):t.length<=255?(this.buffer.push(76),this.buffer.push(t.length)):t.length<=65535?(this.buffer.push(77),this.buffer.push(255&t.length),this.buffer.push(t.length>>>8&255)):(this.buffer.push(78),this.buffer.push(255&t.length),this.buffer.push(t.length>>>8&255),this.buffer.push(t.length>>>16&255),this.buffer.push(t.length>>>24&255)),this.buffer=this.buffer.concat(t),this.chunks.push(t),!0},e.parse(),e},ft.transaction=function(){var t={version:1,lock_time:0,ins:[],outs:[],witness:!1,timestamp:null,block:null,addinput:function(e,r,i,s){var n={};return n.outpoint={hash:e,index:r},n.script=ft.script(i||[]),n.sequence=s||(0==t.lock_time?4294967295:0),this.ins.push(n)},addoutput:function(t,e){var r={};r.value=new w(""+Math.round(1*e*1e4),10);var i=ft.script();return r.script=i.spendToScript(t),this.outs.push(r)},addstealth:function(t,e){var r=w.fromByteArrayUnsigned(Crypto.util.hexToBytes(ft.newPrivkey())),i=EllipticCurve.getSECCurveByName("secp256k1"),s=EllipticCurve.fromHex("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F"),n=w.ZERO,o=EllipticCurve.fromHex("7"),u=new EllipticCurve.CurveFp(s,n,o),h=i.getG().multiply(r),c=u.decodePointHex(t.scankey).multiply(r),a=w.fromByteArrayUnsigned(Crypto.SHA256(c.getEncoded(!0),{asBytes:!0})),p=i.getG().multiply(a),f=u.decodePointHex(t.spendkey).add(p),l=ft.pubkey2address(Crypto.util.bytesToHex(f.getEncoded(!0))),y=[6].concat(Crypto.util.randomBytes(4)).concat(h.getEncoded(!0)),d=ft.script();d.writeOp(106),d.writeBytes(y),v={},v.value=0,v.script=d,this.outs.push(v);var g={};g.value=new w(""+Math.round(1*e*1e4),10);var m=ft.script();return g.script=m.spendToScript(l),this.outs.push(g)},adddata:function(t){if(t.match(/^[a-f0-9]+$/gi)&&t.length<160&&t.length%2==0){var e=ft.script();return e.writeOp(106),e.writeBytes(Crypto.util.hexToBytes(t)),o={},o.value=0,o.script=e,this.outs.push(o)}return!1},listUnspent:function(t,e,r){ft.ajax(ft.host+"?method=blockchain.address.get_utxo_amount&params[]="+t+"&params[]="+e,r,"GET")},addUnspent:function(t,e,r,s,n,o){var u=this;this.listUnspent(t,e,function(t){var e=ft.script(),h=0,c=0,a={},p=(t=JSON.parse(t)).result;for(i=0;i<p.length;i++){var f=p[i],l=f.tx_hash,y=f.tx_pos,d=s||f.script;n&&((e=ft.script()).writeBytes(Crypto.util.hexToBytes(s)),e.writeOp(0),e.writeBytes(ft.numToBytes(1*f.value,8)),d=Crypto.util.bytesToHex(e.buffer));var g=o||!1;u.addinput(l,y,d,g),h+=1*f.value,c++,console.log(f.value)}return a.unspent=p,a.value=h,a.total=c,r(a)})},addUnspentAndSign:function(t,e,r){var i=this,s=ft.wif2address(t);i.addUnspent(s.address,e,function(e){return i.sign(t),r(e)})},broadcast:function(t,e){console.log(e);var r=e||this.serialize();ft.ajax(ft.host+"?uid="+ft.uid+"&key="+ft.key+"&setmodule=bitcoin&request=sendrawtransaction&rawtx="+r+"&r="+Math.random(),t,"GET")},transactionHash:function(t,e){for(var r=ft.clone(this),i=e||1,s=0;s<r.ins.length;s++)t!=s&&(r.ins[s].script=ft.script());var n=this.extractScriptKey(t);if(r.ins[t].script=ft.script(n.script),r.ins&&r.ins[t]){if(1==i);else if(2==i){r.outs=[];for(s=0;s<r.ins.length;s++)t!=s&&(r.ins[s].sequence=0)}else if(3==i){r.outs.length=t+1;for(s=0;s<t;s++)r.outs[s].value=-1,r.outs[s].script.buffer=[];for(s=0;s<r.ins.length;s++)t!=s&&(r.ins[s].sequence=0)}else if(i>=128)if(r.ins=[r.ins[t]],129==i);else if(130==i)r.outs=[];else if(131==i){r.outs.length=t+1;for(s=0;s<t;s++)r.outs[s].value=-1,r.outs[s].script.buffer=[]}var o=Crypto.util.hexToBytes(r.serialize());o=o.concat(ft.numToBytes(parseInt(i),4));var u=Crypto.SHA256(o,{asBytes:!0});return Crypto.util.bytesToHex(Crypto.SHA256(u,{asBytes:!0}))}return!1},transactionHashSegWitV0:function(t,e){var r=this.extractScriptKey(t);if("segwit"!=r.type)return{result:0,fail:"redeemscript",response:"redeemscript missing or not valid for segwit"};if(-1==r.value)return{result:0,fail:"value",response:"unable to generate a valid segwit hash without a value"};var i=Crypto.util.hexToBytes(r.script);20==i.length&&(i=[0,20].concat(i)),22==i.length&&((i=i.slice(1)).unshift(25,118,169),i.push(136,172));var s=ft.numToBytes(r.value,8),n=ft.numToBytes(0,32),o=ft.numToBytes(parseInt(this.version),4),u=[];if(!(e>=80))for(var h=0;h<this.ins.length;h++)u=(u=u.concat(Crypto.util.hexToBytes(this.ins[h].outpoint.hash).reverse())).concat(ft.numToBytes(this.ins[h].outpoint.index,4));var c=u.length>=1?Crypto.SHA256(Crypto.SHA256(u,{asBytes:!0}),{asBytes:!0}):n;u=[];if(!(e>=80)&&2!=e&&3!=e)for(h=0;h<this.ins.length;h++)u=u.concat(ft.numToBytes(this.ins[h].sequence,4));var a=u.length>=1?Crypto.SHA256(Crypto.SHA256(u,{asBytes:!0}),{asBytes:!0}):n,p=Crypto.util.hexToBytes(this.ins[t].outpoint.hash).reverse();p=p.concat(ft.numToBytes(this.ins[t].outpoint.index,4));var f=ft.numToBytes(this.ins[t].sequence,4),l=n;u=[];if(2!=e&&3!=e){for(h=0;h<this.outs.length;h++)u=(u=(u=u.concat(ft.numToBytes(this.outs[h].value,8))).concat(ft.numToVarInt(this.outs[h].script.buffer.length))).concat(this.outs[h].script.buffer);l=Crypto.SHA256(Crypto.SHA256(u,{asBytes:!0}),{asBytes:!0})}else 2==e&&t<this.outs.length&&(u=(u=(u=u.concat(ft.numToBytes(this.outs[t].value,8))).concat(ft.numToVarInt(this.outs[h].script.buffer.length))).concat(this.outs[t].script.buffer),l=Crypto.SHA256(Crypto.SHA256(u,{asBytes:!0}),{asBytes:!0}));var y=ft.numToBytes(this.lock_time,4);e|=forkid;var d=ft.numToBytes(e,4),g=[];g=(g=(g=(g=(g=(g=(g=(g=(g=(g=g.concat(o)).concat(c)).concat(a)).concat(p)).concat(i)).concat(s)).concat(f)).concat(l)).concat(y)).concat(d);var v=Crypto.SHA256(g,{asBytes:!0});return{result:1,hash:Crypto.util.bytesToHex(Crypto.SHA256(v,{asBytes:!0})),response:"hash generated"}},extractScriptKey:function(t){if(this.ins[t]){if(5==this.ins[t].script.chunks.length&&172==this.ins[t].script.chunks[4]&&ft.isArray(this.ins[t].script.chunks[2]))return{type:"scriptpubkey",signed:"false",signatures:0,script:Crypto.util.bytesToHex(this.ins[t].script.buffer)};if(2==this.ins[t].script.chunks.length&&48==this.ins[t].script.chunks[0][0]&&5==this.ins[t].script.chunks[1].length&&177==this.ins[t].script.chunks[1][1])return{type:"hodl",signed:"true",signatures:1,script:Crypto.util.bytesToHex(this.ins[t].script.buffer)};if(2==this.ins[t].script.chunks.length&&48==this.ins[t].script.chunks[0][0])return{type:"scriptpubkey",signed:"true",signatures:1,script:Crypto.util.bytesToHex(this.ins[t].script.buffer)};if(5==this.ins[t].script.chunks.length&&177==this.ins[t].script.chunks[1])return{type:"hodl",signed:"false",signatures:0,script:Crypto.util.bytesToHex(this.ins[t].script.buffer)};if(this.ins[t].script.chunks.length<=3&&this.ins[t].script.chunks.length>0&&(22==this.ins[t].script.chunks[0].length&&0==this.ins[t].script.chunks[0][0]||20==this.ins[t].script.chunks[0].length&&0==this.ins[t].script.chunks[1])){var e=this.witness[t]&&2==this.witness[t].length?"true":"false",r="true"==e?1:0,i=-1;return this.ins[t].script.chunks[2]&&8==this.ins[t].script.chunks[2].length&&(i=ft.bytesToNum(this.ins[t].script.chunks[2])),{type:"segwit",signed:e,signatures:r,script:Crypto.util.bytesToHex(this.ins[t].script.chunks[0]),value:i}}return 0==this.ins[t].script.chunks[0]&&174==this.ins[t].script.chunks[this.ins[t].script.chunks.length-1][this.ins[t].script.chunks[this.ins[t].script.chunks.length-1].length-1]?{type:"multisig",signed:"true",signatures:this.ins[t].script.chunks.length-2,script:Crypto.util.bytesToHex(this.ins[t].script.chunks[this.ins[t].script.chunks.length-1])}:this.ins[t].script.chunks[0]>=80&&174==this.ins[t].script.chunks[this.ins[t].script.chunks.length-1]?{type:"multisig",signed:"false",signatures:0,script:Crypto.util.bytesToHex(this.ins[t].script.buffer)}:0==this.ins[t].script.chunks.length?{type:"empty",signed:"false",signatures:0,script:""}:{type:"unknown",signed:"false",signatures:0,script:Crypto.util.bytesToHex(this.ins[t].script.buffer)}}return!1},transactionSig:function(t,e,r,i){var s=r||1;s|=forkid;var n,o,u,h,c=i||Crypto.util.hexToBytes(this.transactionHash(t,s));if(c){var a=EllipticCurve.getSECCurveByName("secp256k1"),p=ft.wif2privkey(e),f=w.fromByteArrayUnsigned(Crypto.util.hexToBytes(p.privkey)),l=a.getN(),y=w.fromByteArrayUnsigned(c),d=0;do{var g=this.deterministicK(e,c,d),v=a.getG().multiply(g).getX().toBigInteger().mod(l),m=g.modInverse(l).multiply(y.add(f.multiply(v))).mod(l);d++}while(v.compareTo(w.ZERO)<=0||m.compareTo(w.ZERO)<=0);var b=l.shiftRight(1);m.compareTo(b)>0&&(m=l.subtract(m));var B=(n=m,o=v.toByteArraySigned(),u=n.toByteArraySigned(),(h=[]).push(2),h.push(o.length),(h=h.concat(o)).push(2),h.push(u.length),(h=h.concat(u)).unshift(h.length),h.unshift(48),h);return B.push(parseInt(s,10)),Crypto.util.bytesToHex(B)}return!1},deterministicK:function(t,e,r){r=r||0;var i=ft.wif2privkey(t),s=Crypto.util.hexToBytes(i.privkey),n=EllipticCurve.getSECCurveByName("secp256k1").getN(),o=[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],u=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];u=Crypto.HMAC(Crypto.SHA256,o.concat([0]).concat(s).concat(e),u,{asBytes:!0}),o=Crypto.HMAC(Crypto.SHA256,o,u,{asBytes:!0}),u=Crypto.HMAC(Crypto.SHA256,o.concat([1]).concat(s).concat(e),u,{asBytes:!0}),o=Crypto.HMAC(Crypto.SHA256,o,u,{asBytes:!0});var h=[];h=o=Crypto.HMAC(Crypto.SHA256,o,u,{asBytes:!0});for(var c=w.fromByteArrayUnsigned(h),a=0;c.compareTo(n)>=0||c.compareTo(w.ZERO)<=0||a<r;)u=Crypto.HMAC(Crypto.SHA256,o.concat([0]),u,{asBytes:!0}),o=Crypto.HMAC(Crypto.SHA256,o,u,{asBytes:!0}),h=o=Crypto.HMAC(Crypto.SHA256,o,u,{asBytes:!0}),c=w.fromByteArrayUnsigned(h),a++;return c},signinput:function(t,e,r){var i=ft.wif2pubkey(e),s=r||1,n=this.transactionSig(t,e,s),o=ft.script();return o.writeBytes(Crypto.util.hexToBytes(n)),o.writeBytes(Crypto.util.hexToBytes(i.pubkey)),this.ins[t].script=o,!0},signhodl:function(t,e,r){var i=r||1,s=this.transactionSig(t,e,i),n=this.ins[t].script.buffer,o=ft.script();return o.writeBytes(Crypto.util.hexToBytes(s)),o.writeBytes(n),this.ins[t].script=o,!0},signmultisig:function(t,e,r){var i=174==this.ins[t].script.chunks[this.ins[t].script.chunks.length-1]?this.ins[t].script.buffer:this.ins[t].script.chunks[this.ins[t].script.chunks.length-1],s=function(t){for(var e={},r=1;r<t.chunks.length-2;r++)e[r]=Crypto.util.hexToBytes(ft.pubkeydecompress(Crypto.util.bytesToHex(t.chunks[r])));return e}(ft.script(i)),n=function(t){var e={},r=0;if(0==t.chunks[0]&&174==t.chunks[t.chunks.length-1][t.chunks[t.chunks.length-1].length-1])for(var i=1;i<t.chunks.length-1;i++)0!=t.chunks[i]&&(e[++r]=t.chunks[i]);return e}(this.ins[t].script),o=r||1,u=Crypto.util.hexToBytes(this.transactionHash(t,o)),h=Crypto.util.hexToBytes(this.transactionSig(t,e,o));n[ft.countObject(n)+1]=h;var c=ft.script();c.writeOp(0);for(x in s)for(y in n)this.ins[t].script.buffer=i,u=Crypto.util.hexToBytes(this.transactionHash(t,1*n[y].slice(-1)[0])),ft.verifySignature(u,n[y],s[x])&&c.writeBytes(n[y]);return c.writeBytes(i),this.ins[t].script=c,!0},signsegwit:function(t,e,r){var i=r||1,s=ft.wif2pubkey(e),n=ft.segwitAddress(s.pubkey),o=ft.bech32Address(s.pubkey);if(n.redeemscript==Crypto.util.bytesToHex(this.ins[t].script.chunks[0])||o.redeemscript==Crypto.util.bytesToHex(this.ins[t].script.chunks[0])){var u=this.transactionHashSegWitV0(t,i);if(1==u.result){var h=Crypto.util.hexToBytes(u.hash),c=this.transactionSig(t,e,i,h),a=ft.script();a.writeBytes(this.ins[t].script.chunks[0]),this.ins[t].script=a,ft.isArray(this.witness)||(this.witness=[]),this.witness.push([c,s.pubkey]);for(var p=[],f=[],l=0;l<this.ins.length;l++)for(var y=0;y<this.witness.length;y++)if(!f.includes(y)){var d=ft.segwitAddress(this.witness[y][1]),g=ft.bech32Address(this.witness[y][1]),v="";if(this.ins[l].script.chunks.length>=1?v=Crypto.util.bytesToHex(this.ins[l].script.chunks[0]):0==this.ins[l].script.chunks.length&&(v=g.redeemscript),d.redeemscript==v||g.redeemscript==v){p.push(this.witness[y]),f.push(y),g.redeemscript==v&&(this.ins[t].script=ft.script());break}}this.witness=p}}return!0},sign:function(t,e){for(var r=e||1,i=0;i<this.ins.length;i++){var s=this.extractScriptKey(i),n=ft.wif2address(t),o=ft.script().pubkeyHash(n.address);("scriptpubkey"==s.type&&s.script==Crypto.util.bytesToHex(o.buffer)||"empty"==s.type)&&"false"==s.signed?this.signinput(i,t,r):"hodl"==s.type&&"false"==s.signed?this.signhodl(i,t,r):"multisig"==s.type?this.signmultisig(i,t,r):"segwit"==s.type&&this.signsegwit(i,t,r)}return this.serialize()},serialize:function(){var t=[];t=t.concat(ft.numToBytes(parseInt(this.version),4)),ft.isArray(this.witness)&&(t=t.concat([0,1])),t=t.concat(ft.numToVarInt(this.ins.length));for(var e=0;e<this.ins.length;e++){var r=this.ins[e];t=(t=t.concat(Crypto.util.hexToBytes(r.outpoint.hash).reverse())).concat(ft.numToBytes(parseInt(r.outpoint.index),4));var i=r.script.buffer;t=(t=(t=t.concat(ft.numToVarInt(i.length))).concat(i)).concat(ft.numToBytes(parseInt(r.sequence),4))}t=t.concat(ft.numToVarInt(this.outs.length));for(e=0;e<this.outs.length;e++){var s=this.outs[e];t=t.concat(ft.numToBytes(s.value,8));i=s.script.buffer;t=(t=t.concat(ft.numToVarInt(i.length))).concat(i)}if(ft.isArray(this.witness)&&this.witness.length>=1)for(e=0;e<this.witness.length;e++){t=t.concat(ft.numToVarInt(this.witness[e].length));for(var n=0;n<this.witness[e].length;n++)t=(t=t.concat(ft.numToVarInt(Crypto.util.hexToBytes(this.witness[e][n]).length))).concat(Crypto.util.hexToBytes(this.witness[e][n]))}return t=t.concat(ft.numToBytes(parseInt(this.lock_time),4)),Crypto.util.bytesToHex(t)},deserialize:function(t){"string"==typeof t&&(t=Crypto.util.hexToBytes(t));var e=0,r=!1,i=function(r){return 0==r?0:t[++e-1]+256*i(r-1)},s=function(){return t[++e-1]<253?t[e-1]:i(t[e-1]-251)},n=function(r){return e+=r,t.slice(e-r,e)},o=function(){var t=s();return n(t)},u=new ft.transaction;u.version=i(4),0==t[e]&&1==t[e+1]&&(r=!0,u.witness=[],e+=2);for(var h=s(),c=0;c<h;c++)u.ins.push({outpoint:{hash:Crypto.util.bytesToHex(n(32).reverse()),index:i(4)},script:ft.script(o()),sequence:i(4)});var a=s();for(c=0;c<a;c++)u.outs.push({value:ft.bytesToNum(n(8)),script:ft.script(o())});if(1==r)for(c=0;c<h;++c)for(var p=s(),f=0;f<p;f++){var l=s();e+=l,ft.isArray(u.witness[c])||(u.witness[c]=[]),u.witness[c].push(Crypto.util.bytesToHex(t.slice(e-l,e)))}return u.lock_time=i(4),u},size:function(){return(this.serialize().length/2).toFixed(0)}};return t},ft.verifySignature=function(t,e,r){var i,s,n;if(ft.isArray(e)){var o=function(t){var e;if(48!=t[0])throw new Error("Signature not a valid DERSequence");if(2!=t[e=2])throw new Error("First element in signature must be a DERInteger");var r=t.slice(e+2,e+2+t[e+1]);if(2!=t[e+=2+t[e+1]])throw new Error("Second element in signature must be a DERInteger");var i=t.slice(e+2,e+2+t[e+1]);return e+=2+t[e+1],{r:w.fromByteArrayUnsigned(r),s:w.fromByteArrayUnsigned(i)}}(e);i=o.r,s=o.s}else{if("object"!=typeof e||!e.r||!e.s)throw"Invalid value for signature";i=e.r,s=e.s}if(!ft.isArray(r))throw"Invalid format for pubkey value, must be byte array";var u=EllipticCurve.getSECCurveByName("secp256k1");n=EllipticCurve.PointFp.decodeFrom(u.getCurve(),r);var h=w.fromByteArrayUnsigned(t);return ft.verifySignatureRaw(h,i,s,n)},ft.verifySignatureRaw=function(t,e,r,i){var s=EllipticCurve.getSECCurveByName("secp256k1"),n=s.getN(),o=s.getG();if(e.compareTo(w.ONE)<0||e.compareTo(n)>=0)return!1;if(r.compareTo(w.ONE)<0||r.compareTo(n)>=0)return!1;var u=r.modInverse(n),h=t.multiply(u).mod(n),c=e.multiply(u).mod(n);return o.multiply(h).add(i.multiply(c)).getX().toBigInteger().mod(n).equals(e)},ft.base58encode=function(t){for(var e="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",r=w.valueOf(58),i=w.fromByteArrayUnsigned(t),s=[];i.compareTo(r)>=0;){var n=i.mod(r);s.unshift(e[n.intValue()]),i=i.subtract(n).divide(r)}s.unshift(e[i.intValue()]);for(var o=0;o<t.length&&0==t[o];o++)s.unshift(e[0]);return s.join("")},ft.base58decode=function(t){for(var e=w.valueOf(58),r=w.valueOf(0),i=0,s=t.length-1;s>=0;s--){var n="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz".indexOf(t[s]);if(n<0)throw"Invalid character";r=r.add(w.valueOf(n).multiply(e.pow(t.length-1-s))),"1"==t[s]?i++:i=0}for(var o=r.toByteArrayUnsigned();i-- >0;)o.unshift(0);return o},ft.ajax=function(t,e,r,i){var s=!1;try{s=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{s=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){s=new XMLHttpRequest}}if(0==s)return!1;s.open(r,t,!0),s.onreadystatechange=function(){4==s.readyState&&e&&e(s.responseText)},"POST"==r&&s.setRequestHeader("Content-type","application/x-www-form-urlencoded"),s.send(i)},ft.clone=function(t){if(null==t||"object"!=typeof t)return t;var e=new t.constructor;for(var r in t)t.hasOwnProperty(r)&&(e[r]=ft.clone(t[r]));return e},ft.numToBytes=function(t,e){return void 0===e&&(e=8),0==e?[]:-1==t?Crypto.util.hexToBytes("ffffffffffffffff"):[t%256].concat(ft.numToBytes(Math.floor(t/256),e-1))},ft.numToByteArray=function(t){return t<=256?[t]:[t%256].concat(ft.numToByteArray(Math.floor(t/256)))},ft.numToVarInt=function(t){return t<253?[t]:t<65536?[253].concat(ft.numToBytes(t,2)):t<4294967296?[254].concat(ft.numToBytes(t,4)):[255].concat(ft.numToBytes(t,8))},ft.bytesToNum=function(t){return 0==t.length?0:t[0]+256*ft.bytesToNum(t.slice(1))},ft.uint=function(t,e){if(t.length<e)throw new Error("not enough data");for(var r=0,i=0;i<e;i++)r*=256,r+=t[i];return r},ft.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},ft.countObject=function(t){var e,r=0;for(e in t)t.hasOwnProperty(e)&&r++;return r},ft.random=function(t){var e="",r=t||25;for(x=0;x<r;x++)e+="!$%^&*()_+{}:@~?><|./;'#][=-abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890".charAt(Math.floor(62*Math.random()));return e},ft}();
